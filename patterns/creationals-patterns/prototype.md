---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Прототип

## Назначение

Прототип (Prototype) — это порождающий паттерн проектирования, который позволяет копировать объекты, не вдаваясь в подробности их реализации. Прототип поручает создание копий самим копируемым объектам. Для этого в базовый класс добавляется метод клонироания, который создает новый объект на основе существующего. Паттерн вводит общий интерфейс для всех объектов, поддерживающих клонирование. Это позволяет копировать объекты, не привязываясь к их конкретным классам.

## Решаемые задачи

* Уменьшение сложности создания объектов

Паттерн позволяет создавать новые объекты, используя уже существующие объекты в качестве прототипов. Это позволяет избежать дублирования кода и повторного создания объектов с нуля.

* Клонирование объектов

Появляется возможность создавать копии объектов. Это может быть полезно, когда требуется создать множество похожих объектов, которые отличаются лишь некоторыми параметрами.

* Создание сложных объектов

Паттерн прототип предоставляет альтернативу созданию подклассов для конструирования сложных объектов. Вместо того, чтобы создавать множество подклассов для каждой вариации объекта, можно использовать прототипы и клонирование, чтобы создавать новые объекты с нужными параметрами и состоянием.

## Общая реализация на языке C++

{% tabs %}
{% tab title="BaseObject" %}
```cpp
class BaseObject
{
public:
    virtual ~BaseObject() = default;

    virtual unique_ptr<BaseObject> clone() = 0;
};
```
{% endtab %}

{% tab title="ConcreteObject" %}
```cpp
class ConcreteObject : public BaseObject
{
public:
    ConcreteObject() 
    {
        cout << "Default constructor;" << endl; 
    }
    
    ConcreteObject(const Object1& obj) 
    { 
        cout << "Copy constructor;" << endl; 
    }
    
    ~ConcreteObject() 
    { 
        cout << "Destructor;" << endl; 
    }

    virtual unique_ptr<BaseObject> clone() override
    {
        return make_unique<ConcreteObject>(*this)
    }
};
```
{% endtab %}
{% endtabs %}

```cpp
# include <iostream>
# include <memory>

using namespace std;

int main()
{
    shared_ptr<BaseObject> ptr1 = make_shared<ConcreteObject>();    
    auto ptr2 = ptr1->clone();
}
```

## Преимущества

1. Появляется возможность создавать новые объекты, используя уже существующие объекты в качестве прототипов, без необходимости знать структуру этих классов или подробности их создания.
2. Появляется возможность клонировать объекты.
3. Увеличивается скорость создания объектов.
4. Появляется возможность уменьшить дублирование кода инициализации объектов.
5. Альтернатива созданию подклассов для конструирования сложных объектов.

## Недостатки

1. Увеличение сложности кода. Особенно при клонировании составных объектов с вложенными объектами и сложной структурой.
2. Необходимо убедиться в правильности работы клонирующего метода и валидности[^1] клонируемого объекта.

## Связь с другими паттернами

1. Паттерн [Абстрактная фабрика](abstract-factory.md) может использовать прототипы для создания и копирования объектов. Прототипы могут служить в качестве стартовых точек для фабрик, которые создают и возвращают копии этих прототипов с определенными параметрами и состоянием.
2. Паттерн [Строитель](builder.md) может использовать прототипы для создания новых объектов с определенными характеристиками. Вместо того, чтобы создавать объекты с нуля, Строитель может использовать прототипы для клонирования и настройки объектов в соответствии с требуемыми параметрами.
3. При использовании паттерна [Одиночка](singleton.md), прототипы могут быть полезными для создания и хранения единственного экземпляра объекта. Одиночка может использовать прототипы для создания копий себя, когда требуется создать дополнительные экземпляры с теми же параметрами и состоянием.

[^1]: Наличие обязательных полей или свойств, правильность значений и состояния объекта
